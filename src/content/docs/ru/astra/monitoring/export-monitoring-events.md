---
title: Export Monitoring Events
sidebar:
    order: 1
---

Astra позволяет экспортировать события мониторинга со статусом входящих потоков или DVB-адаптеров.

## URL для мониторинга

Адрес сервера мониторинга можно указать в веб-интерфейсе: Настройки → Общие → Мониторинг:

![Monitoring Options](https://cdn.cesbo.com/help/astra/monitoring/export/export-monitoring-events/options.png)

Адрес имеет следующие параметры:

- `interval=30` – этот параметр определяет интервал передачи статистики, измеряемый в секундах. По умолчанию значение этого параметра равно 30.
- `total=1` – этот параметр используется для получения сводной статистики из пакета данных.

Например, с адресом `http://example.com/api#interval=60&total=1` Astra отправляет HTTP POST-запрос на `http://example.com/api` каждую минуту, содержание которого включает JSON со сводной статистикой за одну минуту мониторинга потоков.

## Свойства потока

Свойства потока Astra отправляет только один раз при запуске потока.

```json
[
    {
        "channel": {
            "type": "spts",
            "name": "Channel Name",
            "id": "a002",
            ...
        },
        "timestamp": 1677687308,
        "hostname": "astra"
    }
]
```

- `channel` - конфигурация всего потока
- `timestamp` - время события
- `hostname` - имя хоста сервера

## Статус потока

```json
[
    {
        "count": 0,
        "timestamp": 1677687310,
        "channel_id": "a002",
        "input_id": 1,
        "current": true,
        "onair": false,
        "scrambled": false,
        "bitrate": 3013,
        "packets": 2005,
        "cc_error": 0,
        "sc_error": 0,
        "pes_error": 0,
        "pcr_error": 15
    }
]
```

Этот список описывает параметры, которые предоставляют информацию о ходе работы потока:

- `count` - только для сводных данных, показывает количество секунд, прошедших с последнего сбора статистики
- `timestamp` - время события в формате Unix
- `channel_id` - уникальный идентификатор канала
- `input_id` - номер входа, начинается с 1
- `current` - указывает, что статистика для текущего активного входа
- `onair` - статус потока, быстрая проверка, работает ли он
- `scrambled` - указывает, зашифрован ли поток
- `bitrate` - входной битрейт в Kбит/с
- `packets` - общее количество TS-пакетов
- `cc_error` - общее количество возникших ошибок CC
- `pes_error` - общее количество возникших ошибок PES

Эти данные передаются в формате JSON в виде массива нескольких элементов, каждый элемент представляет собой одну секунду наблюдений. Количество элементов в массиве определяется частотой передачи статистики. Если включена агрегация статистики, то в массиве будет только один элемент, который содержит общее количество ошибок и средний битрейт за период, равный частоте передачи статистики.

## Свойства адаптера

Свойства адаптера Astra отправляет только один раз при запуске адаптера.

```json
[
    {
        "dvb": {
            "name": "11034V @ 13E",
            "id": "a001",
            ....
        },
        "timestamp": 1677687308,
        "hostname": "astra"
    }
]
```

- `dvb` — конфигурация адаптера
- `timestamp` — время события
- `hostname` — имя хоста сервера

## Статус адаптера

```json
[
    {
        "dvb_id": "a0dj",
        "timestamp": 1677687310,
        "status": 31,
        "signal": 76,
        "signal_db": -2488,
        "snr": 60,
        "snr_db": 902,
        "unc": 0,
        "ber": 0,
        "bitrate": 1938
    }
]
```

Этот список описывает параметры, которые предоставляют информацию о ходе работы адаптера:

- `dvb_id` - уникальный идентификатор адаптера
- `timestamp` - время события
- `status` - статус сигнала
- `signal` - приблизительный уровень сигнала в процентах
- `signal_db` - уровень сигнала в `dBm * 100`
- `snr` - приблизительное соотношение сигнал/шум в процентах
- `snr_db` - соотношение сигнал/шум в `dB * 100`
- `ber` - счетчик битовых ошибок
- `unc` - счетчик блоковых ошибок
- `bitrate` - общий битрейт в Kбит/с

Статус сигнала описывает состояние тюнера, представленное 5-битным числом:

- `SIGNAL` — бит сигнала устанавливается, когда тюнер захватывает сигнал
- `CARRIER` — стабильный прием сигнала
- `FEC` — прием данных FEC (прямое исправление ошибок)
- `SYNC` — получена информация для синхронизации
- `LOCK` — тюнер настроен на прием сигнала.

Если тюнер успешно настроен и сигнал зафиксирован, параметр статуса будет установлен на 31.