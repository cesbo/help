---
title: External DVB-CI
description: How to use External DVB-CI adapters with Astra for decrypting channels
sidebar:
    order: 8
---

С ростом цифрового вещания защита контента от несанкционированного доступа стала особенно важной. Именно поэтому многие телевизионные провайдеры, будь то спутниковые, кабельные или эфирные, шифруют контент с использованием систем условного доступа (CAS).

Одним из распространенных методов в этом процессе является Common Interface (CI) — интерфейс, который позволяет модулям условного доступа (CAM) подключаться к DVB-приемнику и расшифровывать защищенные каналы. Расшифровка каналов с помощью внешнего DVB-CI адаптера обеспечивает гибкую структуру головной станции, разделяя части приема и обработки.

## Преимущества внешнего DVB-CI

- Зашифрованные каналы из различных источников могут быть сгруппированы для последующей расшифровки в одном модуле CI. Это может быть весьма полезно, если у вас есть различные DVB транспондеры с зашифрованными каналами.
- Каналы могут приниматься и расшифровываться на отдельных серверах. Это особенно удобно, если вы используете приемники SAT>IP. Вы можете иметь сервер Astra с CI-картами, хранящийся в серверной комнате, в то время как приемники SAT>IP расположены ближе к крыше, где установлены спутниковые антенны. Подробнее о [приеме SAT>IP](/en/astra/receiving/satip-client) с Astra.

## Требования

- Внешний DVB-CI адаптер. Мы тестировали и поддерживаем следующие модели:
    - [DigitalDevices Octopus Twin CI](https://www.digital-devices.eu/shop/en/accessoires/bridge/266/digital-devices-octopus-twin-ci-double-ci-slot-with-2-expansionports)
    - [TBS6900](https://www.tbsdtv.com/products/tbs6900-dvb-dual-pci-e-card.html)
- Модуль условного доступа (CAM)
- SmartCard от вещателя

## Конфигурация Astra

### Создание MPTS

Создайте MPTS с необходимыми каналами в адресе входа, для каждого канала вы должны добавить опцию `cas`, чтобы Astra передавала все необходимое для декодирования. Например:

### Создание Виртуального Адаптера

:::внимание
Виртуальный Адаптер доступен в версиях, выпущенных после 20 сентября 2022 года
:::

Создайте новый адаптер в веб-интерфейсе Astra с значением `CI` в поле `Virtual`. Сохраните настройки адаптера, нажав кнопку "Применить".

Опции CI:

- `Name` - имя адаптера
- `ID` - уникальный идентификатор адаптера. Можно оставить пустым, система создаст id при сохранении адаптера
- `Virtual` - тип Виртуального Адаптера. выберите опцию `CI`
- `Adapter` - номер адаптера CI в системе
- `Stream ID` - идентификатор потока с MPTS. это значение ID MPTS, созданного на первом шаге
- `CI Device` - номер устройства на CI адаптере. По умолчанию: `0`
- `CI Bitrate` - скорость передачи данных TBS CI в Мбит/с. По умолчанию: `70`. Для DigitalDevices скорость может быть определена в настройках драйвера
- `CA Delay` - задержка, в секундах, перед отправкой информации о канале в модуль условного доступа. По умолчанию: `20` секунд

Номер CI адаптера можно найти с помощью команды:

```sh
find /dev/dvb/ -name ca*
```

Пример результата:

```
/dev/dvb/adapter5/ca0
```

Где:

- `5` - номер CI адаптера
- `0` - устройство на CI адаптере

### Сканирование адаптера

Теперь вы можете нажать кнопку Сканировать.

Выберите необходимые программы и добавьте их, нажав кнопку Применить.

## Устранение неполадок

### Модуль CI+ не работает

Модули CI+ предназначены только для потребительского использования и не поддерживаются внешними DVB-CI адаптерами

### Расшифровывается только 1 канал

Количество программ (каналов), которые CAM может расшифровать одновременно, зависит от производителя и/или модели CAM.

### Как проверить меню CAM?

Если вам нужно проверить меню CAM, чтобы получить дополнительные данные о модуле условного доступа или SmartCard, вы можете использовать утилиту цифрового телевидения `gnutv`. Запустите:

```sh
gnutv -adapter N -cammenu
```

Где N — номер CI адаптера.