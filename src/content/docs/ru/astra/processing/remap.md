---
title: "Переопределение PID потоков"
date: 2023-07-17
sidebar:
    order: 4
---

Функция Remap в Astra позволяет изменять идентификатор пакета (PID) для элементарных потоков MPEG-TS.

## Примеры использования[](/ru/astra/processing/mpegts/remap#use-cases)

Ремаппинг PID потоков полезен в различных сценариях:

- Плавное резервирование входов: Если основной и резервный входы имеют разные PID для элементарных потоков видео и аудио, переключение на резервный вход может привести к временному прерыванию воспроизведения. Перестановка PID для обеспечения единообразия основных и резервных входов позволяет сделать переход плавным.
- Подготовка многопрограммного потока (MPTS): При подготовке канала к включению в MPTS-вещание каждый элементарный поток в канале должен обладать уникальным PID. Ремаппинг обеспечивает уникальность этого PID, что позволяет плавно добавить канал в MPTS

## Анализ канала[](/ru/astra/processing/mpegts/remap#analyze-channel)

Для определения доступных элементарных потоков и их PID необходимо проанализировать канал. Это можно сделать, запустив встроенный анализатор MPEG-TS либо из меню канала, либо непосредственно из настроек канала.

![Анализ исходного потока](https://cdn.cesbo.com/help/astra/processing/utilities/remap/analyze-original.png)

На представленном скриншоте мы видим следующие элементарные потоки:

1. Таблица программных карт (PMT) - PID: `374`
2. Видео - ПИД: `371`
3. Аудио - PID: `376`, Язык: `eng` (на английском языке)

Каждый элементарный поток представлен уникальным идентификатором пакета (PID), который может быть использован для ремаппинга потока в Astra.

## Ограничения[](/ru/astra/processing/mpegts/remap#limitations)

Обратите внимание, что значение PID может находиться в диапазоне от 32 до 8190.

## Ремаппинг ввода[](/ru/astra/processing/mpegts/remap#input-remapping)

Для того чтобы выполнить перестановку потоков, изменим PID PMT на 100, PID видеопотока на 101, а PID аудиопотока на 102. Эту операцию можно выполнить, добавив в поле `map.pmt=100&map.video=101&map.audio.eng=102` опция на входной адрес

![Опция ввода](https://cdn.cesbo.com/help/astra/processing/utilities/remap/input-options.png)

## Ремаппинг для всех входов[](/ru/astra/processing/mpegts/remap#remapping-for-all-inputs)

Для ремаппинга потока по всем входам используется параметр `Remap` можно использовать вкладку в настройках канала.

![Параметры перестройки](https://cdn.cesbo.com/help/astra/processing/utilities/remap/remap-options.png)

В поле "Map PIDs", `pmt=100, video=101, audio.eng=102` был установлен. В результате PID видео- и англоязычного аудиопотоков изменяются на 101 и 102, соответственно, по всем входам.

Для проверки результатов примененного фильтра потока нажмите кнопку "Применить", чтобы сохранить изменения. Далее снова запустите встроенный анализатор MPEG-TS. Это позволит проверить, успешно ли отфильтрованы ненужные потоки.

![Анализ ремаппированного потока](https://cdn.cesbo.com/help/astra/processing/utilities/remap/analyze-remapped.png)

## Селекторы[](/ru/astra/processing/mpegts/remap#selectors)

Селектор определяет, какой PID должен быть изменен на новое значение

- `pmt` - PID для таблицы программных карт (PMT)
- `video` - видеопоток
- `audio` - любой аудиопоток. Вы можете задать эту опцию дважды, если у вас, например, несколько аудиопотоков: `video=101, audio=102, audio=103`
- `audio.eng` - аудиопоток с заданным языковым кодом
- `ac3` - Аудиопоток AC3. Сайт `audio` селектор может быть использован и для потоков AC3
- `aac` - Аудиопоток AAC. Сайт `audio` Селектор может быть использован и для потоков ACC
- `371` - исходный ПИД
- `pcr` - PID для пакетов с PCR. Обычно временная метка PCR поставляется вместе с пакетами видеопотока
- `sub` - поток субтитров
- `ttx` - поток телетекста
- `ait` - PID для информационной таблицы приложений (AIT)
