---
title: "SSH: Tunnels"
description: "Port forwarding with SSH"
sidebar:
    order: 12
---

SSH-туннели — это мощный инструмент для безопасной связи, обхода сетевых ограничений и предоставления удаленного доступа к локальным ресурсам.

## Локальная перенаправка порта

Локальная перенаправка порта позволяет перенаправить порт на вашем локальном компьютере на удаленный адрес и порт. Представьте, что у вас есть веб-приложение, работающее на удаленном сервере по адресу `127.0.0.1:8000`. Чтобы получить доступ к этому веб-приложению с вашего локального компьютера, вы можете использовать перенаправление портов SSH:

```bash
ssh -L 8080:127.0.0.1:8000 example.com
```

Теперь в веб-браузере на локальном компьютере перейдите по адресу `http://localhost:8080`, и вы должны получить данные (или увидеть веб-страницу) с вашего удаленного сервера.

- `8080` - номер порта на локальном компьютере с SSH-клиентом
- `127.0.0.1:8000` - IP-адрес и номер порта на удаленном компьютере
- `-fNT` - дополнительные параметры для запуска SSH-клиента в фоновом режиме

## Обратная перенаправка порта

Обратная перенаправка порта позволяет перенаправить порт на удаленном сервере на локальный сервис. Например, чтобы перенаправить удаленный порт 9090 на порт 3000 на вашем локальном компьютере:

```bash
ssh -R 9090:localhost:3000 example.com
```

Теперь все запросы на удаленном сервере к порту `9090` будут перенаправлены на порт `3000` на вашем локальном компьютере.

## Примеры

### Безопасный удаленный доступ к базе данных

**Сценарий**: У вас есть база данных MySQL, работающая на удаленном сервере, и вы хотите получить к ней доступ с вашего локального компьютера. Создайте SSH-туннель для перенаправления удаленного порта MySQL на ваш локальный компьютер:

```bash
ssh -L 3306:localhost:3306 example.com
```

После выполнения этой команды вы можете подключиться к удаленной базе данных MySQL, используя локальный MySQL-клиент, следующим образом:

```bash
mysql -h 127.0.0.1 -P 3306 -u db_user -p
```

### Туннелирование нескольких портов

**Сценарий**: Вам нужно получить доступ к удаленной базе данных на порту `5432` и к веб-приложению на порту `8080` на удаленном сервере.

```bash
ssh -L 8080:localhost:8080 -L 5432:localhost:5432 example.com
```

После выполнения этой команды вы можете получить доступ к удаленному веб-приложению по адресу `http://localhost:8080` и к удаленной базе данных на `localhost:5432`.

### Туннелирование с помощью SSH конфигурационного файла

Для частой настройки SSH-туннелей вы можете настроить SSH-клиент для упрощения процесса, используя конфигурационный файл SSH `~/.ssh/config`.

```
Host example.com
  LocalForward 5432 localhost:5432
  LocalForward 8080 localhost:8080
```

Эта настройка позволяет вам быстро устанавливать SSH-туннели с предопределенными конфигурациями, используя только псевдонимы.

### Доступ к IP-камере в частной сети

**Сценарий**: У вас есть IP-камера в частной сети, которая транслирует видео через RTSP на `rtsp://192.168.1.10:554/stream1`. Вам нужно получить доступ к этому RTSP-потоку с вашего локального компьютера.

```bash
ssh -L 8554:192.168.1.10:554 example.com
```

После выполнения этой команды вы можете получить доступ к RTSP-потоку с вашего локального компьютера, используя RTSP-клиент (например, VLC media player), подключаясь к `rtsp://localhost:8554/stream1`.

1. Откройте VLC Media Player
2. Перейдите в "Медиа" и нажмите "Открыть поток в сети".
3. Введите URL `rtsp://localhost:8554/stream1`.
4. Нажмите "Воспроизвести".

VLC теперь подключится к RTSP-потоку через SSH-туннель, позволяя вам просматривать поток с камеры так, как если бы вы находились в той же частной сети, что и камера.