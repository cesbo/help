---
title: "Configure IGMP Version"
date: 2023-03-02
sidebar:
    order: 5
---

IGMP (Internet Group Management Protocol) — это протокол связи, используемый устройствами в сети для присоединения и выхода из мультикаст-групп. IGMP имеет несколько версий, включая IGMPv2 и IGMPv3, которые предлагают различные функции и улучшения.

Некоторое сетевое оборудование, такое как коммутаторы или маршрутизаторы, может поддерживать только IGMPv2, что может вызвать проблемы, если ваш сервер пытается присоединиться к мультикаст-группе, используя IGMPv3. Поэтому может потребоваться изменить версию IGMP, используемую сервером.

## Конфигурация

Чтобы изменить версию IGMP на вашем сервере, вы можете изменить файл `/etc/sysctl.conf`. Сначала определите интерфейс, который должен использовать другую версию IGMP (например, eth0). Затем добавьте следующую строку в файл `/etc/sysctl.conf`:

```
net.ipv4.conf.eth0.force_igmp_version=2
```

Эта строка заставляет ваш сервер использовать IGMPv2 на указанном интерфейсе. Чтобы применить изменения, сохраните файл и выполните следующую команду:

```
sudo sysctl -p
```

## Проверка версии IGMP

Чтобы подтвердить, что версия IGMP была успешно изменена, вы можете использовать команду tcpdump для захвата сетевого трафика на указанном интерфейсе. Например, чтобы захватить IGMP-трафик на eth0, выполните следующую команду:

```
sudo tcpdump -i eth1 igmp
```

Затем попробуйте подписаться на мультикаст-поток. Например:

```
astra --analyze udp://eth1@239.255.1.1:1234
```

Это отобразит любые IGMP-пакеты на интерфейсе. Проверьте выходные данные, чтобы подтвердить, что теперь используется версия IGMPv2.